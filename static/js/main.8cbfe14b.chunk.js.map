{"version":3,"sources":["Hosts.js","ConnectForm.js","App.js","reportWebVitals.js","index.js"],"names":["Host","props","host_url","host","name","className","href","ip","ipv4","enabled","ipv4_enabled","type","ipv6","ipv6_enabled","IPInfo","td_class","cell_content","address","last_ping","Date","toISOString","split","undefined","last_change","cf_dns_record_id","Hosts","hosts","Object","entries","map","info","onClick","onLogout","LOGIN_ERROR_DESC","is_uri_insecure","uri","startsWith","ConnectForm","url","URL","window","location","base_uri","searchParams","get","api_key","state","credentials","remember","error","handleChange","bind","handleSubmit","onSubmit","event","target","value","checked","this","setState","old_state","preventDefault","error_text","htmlFor","onChange","React","Component","App","updateCredentials","logout","start_screen","getSavedCredentials","screen","login_error","saveCredentials","refreshHosts","then","ok","localStorage","getItem","removeItem","setItem","clearSavedCredentials","reload","fetch","headers","Authorization","r","status","json","catch","data","screens","call","login","loading","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8cbfe14b.chunk.js","sourcesContent":["import React from \"react\";\n\nexport const Hosts = (props) => {\n  const hosts = Object.entries(props.hosts).map(([name, info]) => (\n    <Host host={{ name: name, ...info }} key={name} />\n  ));\n  return (\n    <div>\n      <div className=\"navbar\">\n        <button onClick={props.onLogout}>Logout</button>\n      </div>\n      <div className=\"content\">\n        <table className=\"host-table\">\n          <thead>\n            <tr>\n              <th>Host</th>\n              <th>IPv4</th>\n              <th>IPv6</th>\n            </tr>\n          </thead>\n          <tbody>{hosts}</tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nconst Host = (props) => {\n  const host_url = `https://${props.host.name}`;\n  return (\n    <tr>\n      <td className=\"host-name\">\n        <a href={host_url}>{props.host.name}</a>\n      </td>\n      <IPInfo\n        ip={props.host.ipv4}\n        enabled={props.host.ipv4_enabled}\n        type=\"ipv4\"\n      />\n      <IPInfo\n        ip={props.host.ipv6}\n        enabled={props.host.ipv6_enabled}\n        type=\"ipv6\"\n      />\n    </tr>\n  );\n};\n\nconst IPInfo = (props) => {\n  const td_class = `ip-info type-${props.type}`;\n  const cell_content = props.enabled ? (\n    <table className=\"ip-info\">\n      <tbody>\n        <tr>\n          <th></th>\n          <td className=\"ip\">{props.ip.address}</td>\n        </tr>\n        <tr\n          className={\n            props.ip.last_ping !== _get_current_date_string()\n              ? \"warning\"\n              : undefined\n          }\n        >\n          <th>Last ping</th>\n          <td> {props.ip.last_ping}</td>\n        </tr>\n        <tr>\n          <th>Last change</th>\n          <td>{props.ip.last_change}</td>\n        </tr>\n        <tr>\n          <th>Record ID</th>\n          <td>{props.ip.cf_dns_record_id}</td>\n        </tr>\n      </tbody>\n    </table>\n  ) : (\n    <span className=\"disabled\">Disabled</span>\n  );\n  return <td className={td_class}>{cell_content}</td>;\n};\n\nfunction _get_current_date_string() {\n  return new Date().toISOString().split(\"T\")[0];\n}\n\nexport default Hosts;\n","import React from \"react\";\n\nconst LOGIN_ERROR_DESC = {\n  \"authentication-error\": \"Authentication error.\",\n  \"network-error\": \"Could not reach service.\",\n  \"insecure-service-error\": \"Insecure service. Refusing to connect.\",\n};\n\nexport class ConnectForm extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const url = new URL(window.location);\n    const base_uri = url.searchParams.get(\"base_uri\");\n    const api_key = url.searchParams.get(\"api_key\");\n\n    this.state = {\n      credentials: {\n        base_uri: base_uri || \"\",\n        api_key: api_key || \"\",\n        remember: false,\n      },\n      error: props.error,\n    };\n\n    if (props.credentials !== null && props.credentials !== undefined) {\n      this.state.credentials = {\n        ...this.state.credentials,\n        ...props.credentials,\n      };\n    }\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.onSubmit = props.onSubmit;\n  }\n\n  handleChange(event) {\n    const target = event.target;\n    const value = target.type === \"checkbox\" ? target.checked : target.value;\n\n    let error = null;\n    if (target.name === \"base_uri\" && is_uri_insecure(value)) {\n      error = \"insecure-service-error\";\n    }\n\n    this.setState((old_state) => ({\n      credentials: { ...old_state.credentials, [target.name]: value },\n      error: error,\n    }));\n  }\n\n  handleSubmit(event) {\n    event.preventDefault();\n\n    if (is_uri_insecure(this.state.credentials.base_uri)) {\n      return;\n    }\n\n    this.onSubmit(this.state.credentials);\n  }\n\n  render() {\n    let error = \"\";\n    if (this.state.error !== null) {\n      let error_text = LOGIN_ERROR_DESC[this.state.error];\n      if (error_text === undefined) {\n        error_text = \"Error.\";\n      }\n\n      error = <div className=\"error\">ðŸ›‘ {error_text}</div>;\n    }\n\n    return (\n      <div className=\"login-container\">\n        <form onSubmit={this.handleSubmit}>\n          <label htmlFor=\"base_uri\">Base URI</label>\n          <input\n            name=\"base_uri\"\n            type=\"text\"\n            value={this.state.credentials.base_uri}\n            onChange={this.handleChange}\n          />\n          <label htmlFor=\"api_key\">API Key</label>\n          <input\n            name=\"api_key\"\n            type=\"password\"\n            value={this.state.credentials.api_key}\n            onChange={this.handleChange}\n          />\n          <label htmlFor=\"remember\">\n            <input\n              name=\"remember\"\n              type=\"checkbox\"\n              checked={this.state.credentials.remember}\n              onChange={this.handleChange}\n            />\n            Remember me\n          </label>\n          <button type=\"submit\">Connect</button>\n          {error}\n        </form>\n      </div>\n    );\n  }\n}\n\nfunction is_uri_insecure(uri) {\n  return uri.startsWith(\"http:\");\n}\n\nexport default ConnectForm;\n","import \"./App.scss\";\nimport Hosts from \"./Hosts.js\";\nimport ConnectForm from \"./ConnectForm.js\";\nimport React from \"react\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updateCredentials = this.updateCredentials.bind(this);\n    this.logout = this.logout.bind(this);\n\n    let start_screen = \"login\";\n\n    const credentials = this.getSavedCredentials();\n    if (credentials !== undefined) {\n      start_screen = \"loading\";\n    }\n\n    this.state = {\n      hosts: null,\n      screen: start_screen,\n      credentials: credentials,\n      login_error: null,\n    };\n  }\n\n  componentDidMount() {\n    if (this.state.screen === \"loading\") {\n      this.updateCredentials(this.state.credentials);\n    }\n  }\n\n  updateCredentials(credentials) {\n    if (credentials.remember) {\n      this.saveCredentials(credentials);\n    }\n\n    this.setState(\n      (state, props) => ({ credentials: credentials, screen: \"loading\" }),\n      () => {\n        this.refreshHosts().then((ok) => {\n          if (ok) {\n            this.setState({ screen: \"hosts\" });\n          }\n        });\n      }\n    );\n  }\n\n  getSavedCredentials() {\n    const base_uri = localStorage.getItem(\"base_uri\");\n    const api_key = localStorage.getItem(\"api_key\");\n\n    if (base_uri === null || api_key === null) {\n      return undefined;\n    }\n\n    return {\n      base_uri: base_uri,\n      api_key: api_key,\n      remember: true,\n    };\n  }\n\n  clearSavedCredentials() {\n    localStorage.removeItem(\"base_uri\");\n    localStorage.removeItem(\"api_key\");\n  }\n\n  saveCredentials(credentials) {\n    localStorage.setItem(\"base_uri\", credentials.base_uri);\n    localStorage.setItem(\"api_key\", credentials.api_key);\n  }\n\n  logout() {\n    this.clearSavedCredentials();\n    window.location.reload(true);\n  }\n\n  refreshHosts() {\n    return fetch(\n      `${this.state.credentials.base_uri}/hosts?show_ipv4=true&show_ipv6=true`,\n      {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${this.state.credentials.api_key}`,\n        },\n      }\n    )\n      .then((r) => {\n        if (r.status === 401) {\n          this.setState({\n            login_error: \"authentication-error\",\n            screen: \"login\",\n          });\n          return null;\n        }\n        return r.json();\n      })\n      .catch((error) => {\n        this.setState({ login_error: \"network-error\", screen: \"login\" });\n        return null;\n      })\n      .then((data) => {\n        if (data !== null) {\n          this.setState({ hosts: data.hosts });\n          return true;\n        }\n\n        return false;\n      });\n  }\n\n  render() {\n    return screens[this.state.screen].call(this);\n  }\n}\n\nconst screens = {\n  login: function () {\n    return (\n      <ConnectForm\n        onSubmit={this.updateCredentials}\n        error={this.state.login_error}\n        credentials={this.state.credentials}\n      />\n    );\n  },\n  loading: function () {\n    return <p className=\"loading\">Loading...</p>;\n  },\n\n  hosts: function () {\n    return <Hosts onLogout={this.logout} hosts={this.state.hosts} />;\n  },\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}
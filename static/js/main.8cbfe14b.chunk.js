(this["webpackJsonpdns-update-web"]=this["webpackJsonpdns-update-web"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(10),i=n.n(s),c=(n(16),n(4)),l=n(5),o=n(2),h=n(8),d=n(7),u=(n(17),n(3)),b=n(11),j=n(0),p=function(e){var t="https://".concat(e.host.name);return Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{className:"host-name",children:Object(j.jsx)("a",{href:t,children:e.host.name})}),Object(j.jsx)(O,{ip:e.host.ipv4,enabled:e.host.ipv4_enabled,type:"ipv4"}),Object(j.jsx)(O,{ip:e.host.ipv6,enabled:e.host.ipv6_enabled,type:"ipv6"})]})},O=function(e){var t="ip-info type-".concat(e.type),n=e.enabled?Object(j.jsx)("table",{className:"ip-info",children:Object(j.jsxs)("tbody",{children:[Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{}),Object(j.jsx)("td",{className:"ip",children:e.ip.address})]}),Object(j.jsxs)("tr",{className:e.ip.last_ping!==(new Date).toISOString().split("T")[0]?"warning":void 0,children:[Object(j.jsx)("th",{children:"Last ping"}),Object(j.jsxs)("td",{children:[" ",e.ip.last_ping]})]}),Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Last change"}),Object(j.jsx)("td",{children:e.ip.last_change})]}),Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Record ID"}),Object(j.jsx)("td",{children:e.ip.cf_dns_record_id})]})]})}):Object(j.jsx)("span",{className:"disabled",children:"Disabled"});return Object(j.jsx)("td",{className:t,children:n})};var v=function(e){var t=Object.entries(e.hosts).map((function(e){var t=Object(b.a)(e,2),n=t[0],r=t[1];return Object(j.jsx)(p,{host:Object(u.a)({name:n},r)},n)}));return Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"navbar",children:Object(j.jsx)("button",{onClick:e.onLogout,children:"Logout"})}),Object(j.jsx)("div",{className:"content",children:Object(j.jsxs)("table",{className:"host-table",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Host"}),Object(j.jsx)("th",{children:"IPv4"}),Object(j.jsx)("th",{children:"IPv6"})]})}),Object(j.jsx)("tbody",{children:t})]})})]})},m=n(6),g={"authentication-error":"Authentication error.","network-error":"Could not reach service.","insecure-service-error":"Insecure service. Refusing to connect."};function x(e){return e.startsWith("http:")}var f=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(c.a)(this,n),r=t.call(this,e);var a=new URL(window.location),s=a.searchParams.get("base_uri"),i=a.searchParams.get("api_key");return r.state={credentials:{base_uri:s||"",api_key:i||"",remember:!1},error:e.error},null!==e.credentials&&void 0!==e.credentials&&(r.state.credentials=Object(u.a)(Object(u.a)({},r.state.credentials),e.credentials)),r.handleChange=r.handleChange.bind(Object(o.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(o.a)(r)),r.onSubmit=e.onSubmit,r}return Object(l.a)(n,[{key:"handleChange",value:function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,r=null;"base_uri"===t.name&&x(n)&&(r="insecure-service-error"),this.setState((function(e){return{credentials:Object(u.a)(Object(u.a)({},e.credentials),{},Object(m.a)({},t.name,n)),error:r}}))}},{key:"handleSubmit",value:function(e){e.preventDefault(),x(this.state.credentials.base_uri)||this.onSubmit(this.state.credentials)}},{key:"render",value:function(){var e="";if(null!==this.state.error){var t=g[this.state.error];void 0===t&&(t="Error."),e=Object(j.jsxs)("div",{className:"error",children:["\ud83d\uded1 ",t]})}return Object(j.jsx)("div",{className:"login-container",children:Object(j.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(j.jsx)("label",{htmlFor:"base_uri",children:"Base URI"}),Object(j.jsx)("input",{name:"base_uri",type:"text",value:this.state.credentials.base_uri,onChange:this.handleChange}),Object(j.jsx)("label",{htmlFor:"api_key",children:"API Key"}),Object(j.jsx)("input",{name:"api_key",type:"password",value:this.state.credentials.api_key,onChange:this.handleChange}),Object(j.jsxs)("label",{htmlFor:"remember",children:[Object(j.jsx)("input",{name:"remember",type:"checkbox",checked:this.state.credentials.remember,onChange:this.handleChange}),"Remember me"]}),Object(j.jsx)("button",{type:"submit",children:"Connect"}),e]})})}}]),n}(a.a.Component),_=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).updateCredentials=r.updateCredentials.bind(Object(o.a)(r)),r.logout=r.logout.bind(Object(o.a)(r));var a="login",s=r.getSavedCredentials();return void 0!==s&&(a="loading"),r.state={hosts:null,screen:a,credentials:s,login_error:null},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){"loading"===this.state.screen&&this.updateCredentials(this.state.credentials)}},{key:"updateCredentials",value:function(e){var t=this;e.remember&&this.saveCredentials(e),this.setState((function(t,n){return{credentials:e,screen:"loading"}}),(function(){t.refreshHosts().then((function(e){e&&t.setState({screen:"hosts"})}))}))}},{key:"getSavedCredentials",value:function(){var e=localStorage.getItem("base_uri"),t=localStorage.getItem("api_key");if(null!==e&&null!==t)return{base_uri:e,api_key:t,remember:!0}}},{key:"clearSavedCredentials",value:function(){localStorage.removeItem("base_uri"),localStorage.removeItem("api_key")}},{key:"saveCredentials",value:function(e){localStorage.setItem("base_uri",e.base_uri),localStorage.setItem("api_key",e.api_key)}},{key:"logout",value:function(){this.clearSavedCredentials(),window.location.reload(!0)}},{key:"refreshHosts",value:function(){var e=this;return fetch("".concat(this.state.credentials.base_uri,"/hosts?show_ipv4=true&show_ipv6=true"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.state.credentials.api_key)}}).then((function(t){return 401===t.status?(e.setState({login_error:"authentication-error",screen:"login"}),null):t.json()})).catch((function(t){return e.setState({login_error:"network-error",screen:"login"}),null})).then((function(t){return null!==t&&(e.setState({hosts:t.hosts}),!0)}))}},{key:"render",value:function(){return y[this.state.screen].call(this)}}]),n}(a.a.Component),y={login:function(){return Object(j.jsx)(f,{onSubmit:this.updateCredentials,error:this.state.login_error,credentials:this.state.credentials})},loading:function(){return Object(j.jsx)("p",{className:"loading",children:"Loading..."})},hosts:function(){return Object(j.jsx)(v,{onLogout:this.logout,hosts:this.state.hosts})}},k=_,C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,20)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))};i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(k,{})}),document.getElementById("root")),C()}},[[19,1,2]]]);
//# sourceMappingURL=main.8cbfe14b.chunk.js.map